// Generated by CoffeeScript 1.10.0
(function() {
  $(document).ready(function() {
    var gameState, gameStateURL, getTTTAPIGameState, makeMove, prompt;
    gameState = GameState.newGame();
    prompt = new GamePrompt();
    makeMove = function(event) {
      var space;
      space = event.target.id;
      if (gameState.board[space] === PlayerMark.NONE) {
        $(event.target).html(gameState.currentPlayer);
        $(event.target).toggleClass("unmarked-space marked-space");
        gameState = gameState.makeMove(space);
        $(".unmarked-space").off();
        getTTTAPIGameState(function(data) {
          $(".prompt").html(prompt.promptFor(gameState, data.gameState));
          return $(".unmarked-space").on("click", makeMove);
        });
      }
      return console.log(event);
    };
    $(".unmarked-space").on("click", makeMove);
    gameStateURL = function(rootUrl, gameState) {
      return rootUrl + ("?current_player=" + gameState.currentPlayer + "&board=" + (gameState.board.join()));
    };
    return getTTTAPIGameState = function(onSuccess) {
      return $.ajax({
        url: gameStateURL("http://107.170.25.194:5000/api/game_state", gameState),
        dataType: "json",
        error: function(jqXHR, textStatus, errorThrown) {
          return console.log("error");
        },
        success: function(data, textStatus, jqXHR) {
          onSuccess(data);
          console.log(data);
          return console.log(data.gameState);
        }
      });
    };
  });

}).call(this);
